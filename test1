import csv

def parse_questions(text):
    questions = []
    lines = text.split('\n')
    i = 0

    while i < len(lines):
        line = lines[i].strip()

        if line.startswith("Question"):
            question = ""
            options = ["", "", "", ""]
            correct_answer = ""

            # Extract the question
            question_line = line.replace("Question", "").strip()
            question = question_line

            # Get the options
            for j in range(4):
                i += 1
                if i >= len(lines):
                    break
                option_line = lines[i].strip()
                if option_line.startswith("A)") or option_line.startswith("B)") or option_line.startswith("C)") or option_line.startswith("D)"):
                    option_text = option_line.split(")", 1)[1].strip()
                    options[j] = option_text

            # Get the correct answer
            i += 1
            if i < len(lines):
                answer_line = lines[i].strip()
                if answer_line.startswith("The correct answer is "):
                    correct_answer = answer_line.split("is ")[1].strip().upper()

            # Add to the list
            questions.append({
                "Question": question,
                "Option A": options[0],
                "Option B": options[1],
                "Option C": options[2],
                "Option D": options[3],
                "Correct Answer": correct_answer
            })

        i += 1

    return questions

def save_to_csv(questions, filename):
    with open(filename, 'w', newline='', encoding='utf-8') as csvfile:
        fieldnames = ['Question', 'Option A', 'Option B', 'Option C', 'Option D', 'Correct Answer']
        writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
        writer.writeheader()
        for q in questions:
            writer.writerow(q)

# Main execution
if __name__ == "__main__":
    # Replace this with your actual file path
    file_path = "Pasted_Text_1751377301371.txt"
    output_file = "output.csv"

    with open(file_path, 'r', encoding='utf-8') as f:
        text = f.read()

    questions = parse_questions(text)
    save_to_csv(questions, output_file)

    print(f"Questions have been saved to {output_file}")
